@inherits AdminCompontentBase

<SheetDialog Value=Show ValueChanged=ShowChanged Title="@T("Update Team")" ContentClass="px-sheet-dialog">
    <ElevationTab Dense Class="pt-12 full-height" Tabs='new List<string>{T("Basic Information"),T("Setup team admins"),T("Setup team members")}' ItemsClass="mt-8 full-height">
        <ElevationTabItem>
            <MCard Class="d-flex flex-column full-height">
                <TeamBasicInfo @bind-Value="Dto.TeamBasicInfo" />
                <MCardActions class="d-flex align-center mb-10 px-6">
                    <MButton Text Color="error" OnClick="OnDeleteHandler">
                        @T("Delete")
                    </MButton>
                    <MSpacer />
                    <DefaultButton Medium OnClick="OnUpdateBaseHandler" Disabled="@string.IsNullOrWhiteSpace(Dto.TeamBasicInfo.Name)">@T("Save")</DefaultButton>
                </MCardActions>
            </MCard>
        </ElevationTabItem>
        <ElevationTabItem>
            <MCard Class="d-flex flex-column full-height">
                @if (Show)
                {
                    <TeamAdmin @bind-Value="Dto.TeamAdmin" />
                }
                <MCardActions class="d-flex align-center mb-10 px-6">
                    <MButton Text Color="error" MinWidth="100" OnClick="OnDeleteHandler">
                        @T("Delete")
                    </MButton>
                    <MSpacer />
                    <DefaultButton Medium Class="mr-4"  OnClick="()=>{_adminPreview = true;}">@T("Preview")</DefaultButton>
                    <DefaultButton Medium MinWidth="100" OnClick="OnUpdateAdminHandler">@T("Save")</DefaultButton>
                </MCardActions>
            </MCard>
        </ElevationTabItem>
        <ElevationTabItem>
            <MCard Class="d-flex flex-column full-height">
                @if (Show)
                {
                    <TeamMember @bind-Value="Dto.TeamMember" />
                }
                <MCardActions class="d-flex align-center mb-10 px-6">
                    <MButton Text Color="error" MinWidth="100" OnClick="OnDeleteHandler">
                        @T("Delete")
                    </MButton>
                    <MSpacer />
                    <DefaultButton Medium Class="mr-4" OnClick="()=>{_memberPreview = true;}">@T("Preview")</DefaultButton>
                    <DefaultButton Medium OnClick="OnUpdateMemberHandler">@T("Save")</DefaultButton>
                </MCardActions>
            </MCard>
        </ElevationTabItem>
    </ElevationTab>
</SheetDialog>

<PermissionsPreview @bind-Show="_adminPreview" Value="Dto.TeamAdmin.Permissions.Where(a=>a.Value).Select(a=>a.Key.ToString()).ToList()" />
<PermissionsPreview @bind-Show="_memberPreview" Value="Dto.TeamMember.Permissions.Where(a=>a.Value).Select(a=>a.Key.ToString()).ToList()" />