@inherits AdminCompontentBase
@page "/permission/index"

<MRow Class="full-height">
    <MCol Md="@("auto")" Class="d-flex flex-column">
        <ClickedExtend Split=true MaxWidth=300>
            <MSelect @bind-Value="@value3"
                     HideDetails=true
                     Solo Dense Class="elevation-0"
                     Items="@items"
                     ItemText="u => u.Label"
                     ItemValue="u => u.Value">
            </MSelect>
        </ClickedExtend>
        <MCard style="width:300px;" Class="flex-grow-1 mt-4 pt-4">
            <ElevationTab TabMinWidth="120" TabWindowClass="mt-4" Headers='new List<string>{T("Menu Permission"),T("Api Permission")}' Dense @bind-TabIndex="_tab">
                <ElevationTabItem>
                    <MTreeview @bind-Active="_menuActive"
                               Items="_menuPermissions"
                               Activatable Hoverable
                               ItemText="r=>r.Name"
                               ItemKey="r=>r.Id"
                               ItemChildren="r=>r.Children">
                        <LabelContent>
                            <MHover Context="hoverComtext">
                                <div @attributes="hoverComtext.Attrs" class="px-2 d-flex justify-space-between align-center">
                                    <span>@context.Item.Name</span>
                                    <MIcon Size=20 OnClick="()=>_addMenuPermission = true" Style="@(hoverComtext.Hover?"display:flex":"display:none")">mdi-plus</MIcon>
                                </div>
                            </MHover>
                        </LabelContent>
                    </MTreeview>
                </ElevationTabItem>
                <ElevationTabItem>
                    <MTreeview @bind-Active="_apiActive"
                               Items="_apiPermissions"
                               Activatable Hoverable
                               ItemText="r=>r.Name"
                               ItemKey="r=>r.Id"
                               ItemChildren="r=>r.Children">
                        <LabelContent>
                            <MHover Context="hoverComtext">
                                <div @attributes="hoverComtext.Attrs" class="px-2 d-flex justify-space-between align-center">
                                    <span>@context.Item.Name</span>
                                    <MIcon Size=20 OnClick="()=>_addApiPermission = true" Style="@(hoverComtext.Hover?"display:flex":"display:none")">mdi-plus</MIcon>
                                </div>
                            </MHover>
                        </LabelContent>
                    </MTreeview>
                </ElevationTabItem>
            </ElevationTab>
        </MCard>
    </MCol>
    <MCol Class="full-height">
        <MWindow @bind-Value="_tab" Reverse Class="full-height">
            <MWindowItem Value="0" Class="full-height">
                <MCard Class="full-height d-flex flex-column">
                    <MCardTitle>
                        <h6>@T("Permission Info")</h6>
                    </MCardTitle>
                    <MCardText>
                        <MRow>
                            <MCol Md=6>
                                <MSelect @bind-Value="_menuPermissionDetailDto.AppId"
                                         Label="@T("Pre Code Select")"
                                         Outlined Dense HideDetails="@("auto")"
                                         Items="@items"
                                         ItemText="u => u.Label"
                                         ItemValue="u => u.Value">
                                </MSelect>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Code")" @bind-Value="_menuPermissionDetailDto.Code" Messages='new List<string>{"推荐Code方式，格式参考示例：resource.method"}'>
                                </DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Permission Name")" @bind-Value="_menuPermissionDetailDto.Name"></DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Permission Level")" @bind-Value="_menuPermissionDetailDto.ParentId"></DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Icon Code")" @bind-Value="_menuPermissionDetailDto.Icon">
                                    <PrependContent>
                                        <div class="d-flex align-center mt-n1">
                                            <MIcon Size=30>
                                                mdi-image
                                            </MIcon>
                                        </div>
                                    </PrependContent>
                                </DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                 <MSelect @bind-Value="_menuPermissionDetailDto.Type"
                                         Label="@T("Permission Type")"
                                         Outlined Dense HideDetails="@("auto")"
                                         Items="@_menuPermissionTypes"
                                         ItemText="u => u.Text"
                                         ItemValue="u => u.Value">
                                </MSelect>
                            </MCol>
                            <MCol Md=12>
                                <DefaultTextField Label="@T("Permission Url")" @bind-Value="_menuPermissionDetailDto.Url"></DefaultTextField>
                            </MCol>
                            <MCol Md=12>
                                <MAutocomplete @bind-Value="_values"
                                               Items="_items"
                                               ItemText="r=>r"
                                               ItemValue="r=>r"
                                               Outlined
                                               Dense Chips
                                               SmallChips
                                               Label="@T("Mount Api Permission")"
                                               Multiple></MAutocomplete>
                            </MCol>
                            <MCol Md=12>
                                <GroupBox Title="@T("Permission Role")">
                                    <MChip Small>
                                        UI
                                    </MChip>
                                    <MChip Small>
                                        UX
                                    </MChip>
                                </GroupBox>
                            </MCol>
                            <MCol Md=12>
                                <GroupBox Title="@T("Permission User")" class="mt-3">
                                    <div>
                                        <MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip>
                                    </div>
                                    <div class="mt-3">
                                        <MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip><MChip Small>
                                            UX
                                        </MChip>
                                    </div>
                                </GroupBox>
                            </MCol>
                            <MCol Md=12>
                                <MTextarea class="mt-6" Label="@T("Description")" @bind-bind-Value="_menuPermissionDetailDto.Description" Outlined Height="120" NoResize>
                                </MTextarea>
                            </MCol>
                        </MRow>
                    </MCardText>
                    <MCardActions class="d-flex align-center mb-10 px-6">
                        <MSwitch @bind-Value="_enabled" Inset Label="@T("Enable")" class="mt-0"></MSwitch>
                        <MSpacer />
                        <MButton Text Class="error--text" MinWidth="100">@T("Delete Permission")</MButton>
                        <MButton class="rounded-pill primary" MinWidth="100">@T("Save")</MButton>
                    </MCardActions>
                </MCard>
            </MWindowItem>
            <MWindowItem Value="1" Class="full-height">
                <MCard Class="full-height d-flex flex-column">
                    <MCardTitle>
                        <h6>@T("Permission Info")</h6>
                    </MCardTitle>
                    <MCardText>
                        <MRow>
                            <MCol Md=6>
                                <MSelect @bind-Value="@value3"
                                         Label="@T("Pre Code Select")"
                                         Outlined Dense HideDetails="@("auto")"
                                         Items="@items"
                                         ItemText="u => u.Label"
                                         ItemValue="u => u.Value">
                                </MSelect>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Code")" @bind-Value="_apiPermissionDetailDto.Code" Messages='new List<string>{"推荐Code方式，格式参考示例：resource.method"}'>
                                </DefaultTextField> 
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Permission Name")" @bind-Value="_apiPermissionDetailDto.Name"></DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Permission Url")" @bind-Value="_apiPermissionDetailDto.Url"></DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                <DefaultTextField Label="@T("Icon Code")" @bind-Value="_apiPermissionDetailDto.Icon">
                                    <PrependContent>
                                        <div class="d-flex align-center mt-n1">
                                            <MIcon Size=30>
                                                mdi-image
                                            </MIcon>
                                        </div>
                                    </PrependContent>
                                </DefaultTextField>
                            </MCol>
                            <MCol Md=6>
                                <MSelect @bind-Value="@_apiPermissionDetailDto.Type"
                                         Label="@T("Permission Type")"
                                         Outlined Dense HideDetails="@("auto")"
                                         Items="@_apiPermissionTypes"
                                         ItemText="u => u.Text"
                                         ItemValue="u => u.Value">
                                </MSelect>
                            </MCol> 
                            <MCol Md=12>
                                <MTextarea class="mt-6" Label="@T("Description")" @bind-Value="_apiPermissionDetailDto.Description" Outlined Height="120" NoResize>
                                </MTextarea>
                            </MCol>
                        </MRow>
                    </MCardText>
                    <MCardActions class="d-flex align-center mb-10 px-6">
                        <MSpacer />
                        <MButton Text Class="error--text" MinWidth="100">@T("Delete Permission")</MButton>
                        <MButton class="rounded-pill primary" MinWidth="100">@T("Save")</MButton>
                    </MCardActions>
                </MCard>
            </MWindowItem>
        </MWindow>
    </MCol>
</MRow>

<AddMenuPermission @bind-Show=_addMenuPermission PermissionTypes=_menuPermissionTypes/>
<AddApiPermission @bind-Show=_addApiPermission PermissionTypes=_apiPermissionTypes/>